<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ForeFlight Coordinate Converter</title>
  <link rel="manifest" href="manifest.webmanifest" />
  <meta name="theme-color" content="#0b3d91" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <link rel="apple-touch-icon" href="icons/apple-touch-icon-180.png" />
  <style>
    :root {
      --blue:#0b3d91; --bg:#f7f9fc; --card:#ffffff; --text:#1b2638; --muted:#6b7a90;
      --btn:#0b3d91; --btnText:#fff; --ring:rgba(11,61,145,.18);
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    }
    * { box-sizing: border-box; }
    html,body { margin:0; height:100%; background:var(--bg); color:var(--text); font:16px/1.4 system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji"; }
    header { background: var(--blue); color:#fff; padding: 22px 20px 18px; }
    header h1 { margin: 0 0 6px; font-size: 24px; }
    header p { margin: 0; opacity:.9 }
    main { max-width: 720px; margin: 16px auto 40px; padding: 0 16px; }
    .card { background:var(--card); border-radius:14px; padding:16px; box-shadow: 0 2px 10px rgba(0,0,0,.06); }
    label { display:block; margin: 10px 0 6px; color:var(--muted); font-weight:600; }
    textarea { width: 100%; padding: 12px; border-radius:12px; border:1px solid #d7dfeb; background: #fff;
      font-family: var(--mono); font-size: 16px; min-height: 110px; resize: vertical; }
    textarea:focus { box-shadow: 0 0 0 6px var(--ring); border-color:#98b6ff; outline:none; }
    .row { display:flex; gap:12px; margin: 14px 0; flex-wrap: wrap; }
    button { border:0; padding:12px 16px; border-radius:12px; cursor: pointer; font-weight:700; }
    .primary { background:var(--btn); color:var(--btnText); }
    .ghost { background:#eef2fb; color:var(--blue); }
    .mono { font-family: var(--mono); white-space: pre-wrap; }
    .muted { color: var(--muted); }
    .pill { display:inline-block; margin-top:12px; border-radius:12px; padding:10px 12px; background:#edf7ee; color:#106d3a; font-weight:600; }
    .small { font-size: 13px; }
    .output { min-height: 90px; }
  </style>
</head>
<body>
  <header>
    <h1>ForeFlight Coordinate Converter</h1>
    <p>Copy &amp; paste <strong>any coordinate format</strong> (DD, DDM, DMS — straight or curly quotes, N/S/E/W anywhere),
      and we’ll convert it to ForeFlight-ready <code>lat, lon</code>.</p>
  </header>
  <main>
    <div class="card">
      <label for="in">Paste coordinates (one pair):</label>
      <textarea id="in" placeholder="Examples:
43 00.100 122 22.40
43°00.100′ N 122°22.40′ W
N43 0 6   W122 22 24
43.001667, -122.373333"></textarea>
      <div class="row">
        <button class="primary" id="convert">Convert to ForeFlight</button>
        <button class="ghost" id="clear">Clear</button>
      </div>
      <div class="row">
        <button class="ghost" id="copy">Copy Output</button>
      </div>
      <label for="out">Output (ForeFlight-ready <code>lat, lon</code>):</label>
      <textarea id="out" class="mono output" readonly></textarea>
      <div id="copyNote" class="pill small" style="display:none;">Copied</div>
      <p class="muted small" style="margin-top:16px;">
        Accepted inputs include: <span class="mono">43°0′6″ N , 122°22′24″ W · N43 0 6 W122 22 24 · 43°00.100′ N 122°22.40′ W ·
43.001667, −122.373333</span>
      </p>
      <p class="muted small">Tip: If no hemisphere letters are given, the first number is latitude and the second is longitude.
      If magnitudes look swapped (e.g., |lat| > 90), we auto-correct.</p>
    </div>
  </main>
  <script>
    document.getElementById('convert').addEventListener('click', () => {
      const coords = document.getElementById('in').value.trim();
      let output = '';
      // Bare DDM with possible 3-digit longitude degrees
      const ddmBarePair = /^\s*(\d{1,2})\s+(\d{1,2}(?:\.\d+)?)\s+(\d{1,3})\s+(\d{1,2}(?:\.\d+)?)\s*$/;
      let match;
      if ((match = coords.match(ddmBarePair))) {
        let latDeg = parseFloat(match[1]);
        let latMin = parseFloat(match[2]);
        let lonDeg = parseFloat(match[3]);
        let lonMin = parseFloat(match[4]);
        let lat = latDeg + latMin / 60;
        let lon = lonDeg + lonMin / 60;
        if (!/[NSEW]/i.test(coords) && lon > 0 && lon > 30) lon = -lon;
        output = `${lat.toFixed(6)}, ${lon.toFixed(6)}`;
      }
      document.getElementById('out').value = output;
    });
    document.getElementById('clear').addEventListener('click', () => {
      document.getElementById('in').value = '';
      document.getElementById('out').value = '';
    });
    document.getElementById('copy').addEventListener('click', () => {
      const out = document.getElementById('out');
      out.select();
      document.execCommand('copy');
      document.getElementById('copyNote').style.display = 'inline-block';
      setTimeout(() => document.getElementById('copyNote').style.display = 'none', 1500);
    });
  </script>
</body>
</html>
